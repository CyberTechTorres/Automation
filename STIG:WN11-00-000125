<#
.SYNOPSIS
   Disables Copilot which prevent accidental transmission of system or user data outside the organization's secure environment. Disabling Copilot helps reduce the risk of unapproved data sharing, potential privacy violations, 
   and the possibility of sensitive information being exposed to unauthorized parties

.NOTES
    Author          : Andres Torres
    LinkedIn        : linkedin.com/in/andres-torres-richardson
    GitHub          : github.com/CyberTechTorres
    Date Created    : 2025-11-03
    Last Modified   : 2025-11-03
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN11-00-000125

.TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
    Put any usage instructions here.
    Example syntax:
    PS C:\> .\STIG:WN11-00-000125
#>

# Registry path for per-user Copilot policy
# We are modifying registry which in turn over rides Group Policy editor. 
$regPath = "HKCU:\Software\Policies\Microsoft\Windows\WindowsCopilot"

# Create the registry key if it does not exist
if (-not (Test-Path $regPath)) {
    New-Item -Path $regPath -Force | Out-Null
}

# Set the policy value to disable Copilot (1=Disabled)
Set-ItemProperty -Path $regPath -Name "TurnOffWindowsCopilot" -Value 1 -Type DWord

# Output status for audit
$copilotStatus = Get-ItemPropertyValue -Path $regPath -Name "TurnOffWindowsCopilot"
Write-Output "Copilot disabled for current user. Value = $copilotStatus (1 means Disabled)"

