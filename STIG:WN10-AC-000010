<#
.SYNOPSIS
    This PowerShell script ensures that the bad logon attempts must be reasonably small to minimize the possibility of a successful password attack, 
    while allowing for honest errors made during a normal user logon.

.NOTES
    Author          : Andres Torres
    LinkedIn        : linkedin.com/in/andres-torres-richardson
    GitHub          : github.com/CyberTorresTech
    Date Created    : 2025-10-07
    Last Modified   : 2025-10-07
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN10-AC-000010

.TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
    Put any usage instructions here.
    Example syntax:
    PS C:\> .\STIG-WN10-AC-000010.ps1 
#>

#"secedit /export /cfg secpol.cfg": Exports the current local security policy to a file named secpol.cfg.  "/cfg" specifies the output file name. If you don't provide /db, it uses the default system security database
#"gc secpol.cfg": reads the file (alias for Get-Content) 
#"| % { ... } (or | ForEach-Object { ... })": for each line of the file, do what's inside the {}.
#"\s*=\s*\d+": is a regular expression pattern that matches a specific format in a line of text. \s* means zero or more whitespace characters (spaces or tabs) and \d+ means one or more digits (so it matches numbers like 3, 10, 123).
#"Set-Content secpol.cfg": Overwrites the old file with the updated content.
#"secedit /configure /db secedit.sdb /cfg secpol.cfg /areas SECURITYPOLICY": applies the security settings in secpol.cfg to the system.
#"db secedit.sdb": Specifies the database location.
#"/areas SECURITYPOLICY": Only applies the security policy section.â€‹
#"Remove-Item secpol.cfg": Removes the temporary config file after the policy changes have been applied.


# Set account lockout threshold to 3
secedit /export /cfg secpol.cfg                        
(gc secpol.cfg) | % { $_ -replace '^LockoutBadCount\s*=\s*\d+', 'LockoutBadCount = 3' } | Set-Content secpol.cfg   
secedit /configure /db secedit.sdb /cfg secpol.cfg /areas SECURITYPOLICY
Remove-Item secpol.cfg
